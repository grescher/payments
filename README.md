# Курсове завдання: Система "Платежі"

Клієнт реєструється в системі і має одну або кілька Кредитних карт, кожна з яких відповідає певному Рахунку в системі. Клієнт за допомогою Рахунку може здійснити Платіж. Платіж має один з двох статусів: 'підготовлений' або 'відправлений'.

Клієнт має особистий кабінет, в якому може переглядати інформацію про свої платежі та рахунки. Необхідно реалізувати можливість сортування (SQL):

- платежів:
  - за номером (string);
  - за датою (від старих до нових, від нових до старих);
- рахунків:
  - за номером (primary key);
  - за найменуванням рахунку (IBAN string);
  - за розміром залишку коштів на рахунку.

Клієнт може поповнити або заблокувати один зі своїх рахунків.
Для поповнення рахунку клієнт повинен зробити запит до системи на поповнення.
Для розблокування рахунку клієнт повинен зробити запит до системи на розблокування.
Клієнт може створювати нові картки.
Усі дії повинні фіксуватися у журналі повідомлень, та формуватися у ланцюжки повідомлень.

Адміністратор системи володіє правами:

- блокування / розблокування користувача;
- блокування / розблокування одного з рахунків користувача.

Весь функціонал повинен були реалізовано як сервіс(и) з передачею даних у вигляді JSON.
Реалізація frontend не обов'язкова.

## Вимоги до проекту

Завдання фінального проекту - розробити REST-застосунок, що підтримує функціональність відповідно до варіанту завдання. Вимоги до реалізації:

1. На основі сутностей предметної області створити моделі (структури), які їм відповідають.
2. Інформацію щодо предметної області зберігати у реляційній базі даних (в якості СУБД рекомендується використовувати PostgreSQL).
3. Для доступу до даних використовувати бібліотеку `database/sql` або `gorm`.
4. Застосунок має підтримувати роботу з кирилицею (бути багатомовним), в тому числі при зберіганні інформації в базі даних:
    - повинна бути підтримка введення, виведення і зберігання інформації (в базі даних), записаної на різних мовах;
    - в якості мов обрати мінімум дві: одна на основі кирилиці (українська), інша на основі латиниці (англійська).
5. Будь яка архітектура та паттерн проекту, головне щоб відповідала Domain-Driven Design (DDD).
6. Реалізувати шаблон пагінація. При запитах до бази даних з оператором SELECT – використовувати OFFSET та LIMIT.
7. Контейнеризувати проект, використовувати Docker та рекомендовано Docker-Compose для запуску.
8. Конфігурацію у додаток слід завантажувати зі змінних оточення (для Docker-Composer слід розміщати змінні у файлі `.env` (детальніше дивиться [https://docs.docker.com/compose/env-file/])
9. У застосунку рекомендовано реалізувати аутентифікацію і авторизацію, розмежування прав доступу користувачів системи до компонентів програми за ролями. Хешування паролів обов'язкове, бажано за алгоритмом SHA-256.
10. Код повинен містити коментарі документації (усі структури, функції, нетривіальні методи і конструктори).
11. Застосунок має бути покритим модульними тестами (мінімальний відсоток покриття 40%). Написання інтеграційних тестів заохочуються.
12. Усі вхідні дані повинні валідуватися.
13. Застосунок має коректно реагувати на помилки та виключні ситуації різного роду.
14. Самостійне розширення постановки задачі по функціональності заохочується!
15. За три дні до моменту старту захистів проектів (інтерв'ю) необхідно підготувати у вигляді окремого файлу схему бази даних, а також надати посилання на репозиторій з проектом.
16. Виконати коректну обробку завершення програми. У програм не повинно виникати PANIC.

## API Schema

- POST /auth/signup
- POST /auth/login
- GET /user/{id}
- GET /accounts/{id}
- PUT /accounts/{id}
- ...
- POST /payments

## DB Schema

`user` table:

- id
- name
- email
- password_hash
- is_admin
- is_active

`account` table:

- id
- user_id
- name
- balance
- is_active

`payment` table:

- id
- sender_id
- recipient_id
- amount
- created_at
- completed_at
- status (prepared, completed) // [https://www.postgresql.org/docs/current/datatype-enum.html]

`log` table:

- id
- date
- category (block_card, unblock_card, create_user, block_user, unblock_user, balance)
- user_id
- description

## Docker commands

```term
docker run --name payments_db -p 127.0.0.1:5432:5432 -e POSTGRES_PASSWORD=lthgfhjk -e POSTGRES_USER=payments -e POSTGRES_DB=payments -d postgres
```
